{% extends 'new_base.html' %}
{% load static %}
{% load custom_filters %}
{% block title %}Auctions | {{ title }} {% endblock %}




{% block body %}




    <!-- Page Content -->
    <div class="container" id="main-content">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}


        <div class="container-content">
            <h1 class='h3 mb-4 text-gray-800'>Dashboard</h1>

            <!-- Tab Container -->
            <div class="card mb-4">
                <div class="px-3">
                    <!-- Tab Navigation for Desktop -->
                    <ul class="nav nav-tabs card-header-tabs mb-1 mt-2 row-cols-5 d-none" id="dashboardTabs"
                        role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if active_tab == 'orders' %}active{% endif %} w-100"
                                    id="orders-tab"
                                    data-bs-toggle="tab"
                                    data-bs-target="#orders" type="button" role="tab" aria-controls="orders"
                                    aria-selected="{% if active_tab == 'orders' %}true{% else %}false{% endif %}">
                                <div class="card text-center tab-nav">
                                    <h5 class="card-header">{{ order_status|capfirst }} Orders</h5>
                                    <div class="card-body">
                                        <p class="card-text">{{ orders_count|default:"0" }}</p>
                                    </div>
                                </div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if active_tab == 'sales' %}active{% endif %} w-100"
                                    id="sales-tab"
                                    data-bs-toggle="tab"
                                    data-bs-target="#sales"
                                    type="button" role="tab" aria-controls="sales"
                                    aria-selected="{% if active_tab == 'sales' %}true{% else %}false{% endif %}">
                                <div class="card text-center tab-nav">
                                    <h5 class="card-header">{{ sales_status|capfirst }} Sales</h5>
                                    <div class="card-body">
                                        <p class="card-text">{{ sales_count|default:"0" }}</p>
                                    </div>
                                </div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if active_tab == 'active' %}active{% endif %} w-100"
                                    id="active-bids-tab" data-bs-toggle="tab"
                                    data-bs-target="#myActiveBids"
                                    type="button" role="tab" aria-controls="activeBids"
                                    aria-selected="{% if active_tab == 'active' %}true{% else %}false{% endif %}">
                                <div class="card text-center tab-nav">
                                    <h5 class="card-header">{{ bid_status|capfirst }} Active Bids</h5>
                                    <div class="card-body">
                                        <p class="card-text">{{ auction_count|default:"0" }}</p>
                                    </div>
                                </div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if active_tab == 'listings' %}active{% endif %} w-100"
                                    id="listings-tab" data-bs-toggle="tab"
                                    data-bs-target="#listings"
                                    type="button" role="tab" aria-controls="listings"
                                    aria-selected="{% if active_tab == 'listings' %}true{% else %}false{% endif %}">
                                <div class="card text-center tab-nav">
                                    <h5 class="card-header">Listings</h5>
                                    <div class="card-body">
                                        <p class="card-text">{{ listings_count|default:"0" }}</p>
                                    </div>
                                </div>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link {% if active_tab == 'settings' %}active{% endif %} w-100"
                                    id="settings-tab" data-bs-toggle="tab"
                                    data-bs-target="#settings"
                                    type="button" role="tab" aria-controls="settings"
                                    aria-selected="{% if active_tab == 'settings' %}true{% else %}false{% endif %}">
                                <div class="card text-center tab-nav">
                                    <h5 class="card-header">Settings</h5>
                                    <div class="card-body">
                                        <i class="fa-solid fa-gears"></i>
                                    </div>
                                </div>
                            </button>
                        </li>
                    </ul>

                    <!-- Dropdown Menu for Mobile -->
                    <div class="dropdown mt-3 my-2 d-flex justify-content-end">
                        <button class="btn btn-primary dropdown-toggle w-100" type="button" id="dropdownMenuButton"
                                data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fas fa-bars me-2"></i> Menu
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <li>
                                <a class="dropdown-item {% if active_tab == 'orders' %}active{% endif %}" href="#orders"
                                   data-bs-toggle="tab" role="tab">Orders</a>
                            </li>
                            <li>
                                <a class="dropdown-item {% if active_tab == 'sales' %}active{% endif %}" href="#sales"
                                   data-bs-toggle="tab" role="tab">Sales</a>
                            </li>
                            <li>
                                <a class="dropdown-item {% if active_tab == 'active' %}active{% endif %}"
                                   href="#myActiveBids" data-bs-toggle="tab" role="tab">Active Bids</a>
                            </li>
                            <li>
                                <a class="dropdown-item {% if active_tab == 'listings' %}active{% endif %}"
                                   href="#listings"
                                   data-bs-toggle="tab" role="tab">Listings</a>
                            </li>
                            <li>
                                <a class="dropdown-item {% if active_tab == 'settings' %}active{% endif %}"
                                   href="#settings"
                                   data-bs-toggle="tab" role="tab">Settings</a>
                            </li>
                        </ul>
                    </div>

                </div>
                <div class="">
                    <div class="tab-content" id="dashboardTabsContent">
                        <!-- My Orders Tab -->
                        <div class="tab-pane fade {% if active_tab == 'orders' %}show active{% else %}{% endif %}"
                             id="orders"
                             role="tabpanel" aria-labelledby="orders-tab">

                            <!-- My Orders -->
                            <div class='my-2 border-top'>
                                <div class='card-header d-flex justify-content-between align-items-center'>
                                    <div>
                                        <i class='fas fa-table me-1'></i>
                                        {{ order_status|capfirst }} Orders
                                    </div>
                                    <div class="filter-container">
                                        <!-- Filter Button for Mobile -->
                                        <button class="btn btn-primary d-md-none" type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#filterCollapse" aria-expanded="false"
                                                aria-controls="filterCollapse">
                                            <i class="fas fa-filter me-1"></i> Filters
                                        </button>

                                        <!-- Filter Form -->
                                        <div class="collapse d-md-block" id="filterCollapse">
                                            <form method="GET"
                                                  class="d-flex flex-column flex-md-row align-items-md-center mt-3 mt-md-0">
                                                <input type="hidden" name="active_tab" value="orders">

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="order_status" class="form-select">
                                                        <option value="">All Orders</option>
                                                        <option value="pending"
                                                                {% if order_status == 'pending' %}selected{% endif %}>
                                                            Pending
                                                        </option>
                                                        <option value="processing"
                                                                {% if order_status == 'processing' %}selected{% endif %}>
                                                            Processing
                                                        </option>
                                                        <option value="shipped"
                                                                {% if order_status == 'shipped' %}selected{% endif %}>
                                                            Shipped
                                                        </option>
                                                        <option value="completed"
                                                                {% if order_status == 'completed' %}selected{% endif %}>
                                                            Completed
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <input type="date" name="order_date" class="form-control"
                                                           value="{{ request.GET.date }}">
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <button type="submit" class="btn btn-primary">Filter</button>
                                                </div>

                                                {% if order_status != 'All' %}
                                                    <div class="input-group">
                                                        <a href="{% url 'dashboard' %}?active_tab=orders&order_status=&order_date="
                                                           class="btn btn-secondary">Reset</a>
                                                    </div>
                                                {% endif %}
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class='card-body'>
                                    <div class="table-like" id="table-like">
                                        <div class="row header table-like-row">
                                            <div class="cell col-md-2 image-col"></div>
                                            <div class="cell col-md-7">Order Details</div>
                                            <div class="cell col-md-3 align-items-center">Actions</div>
                                        </div>

                                        {% for order in orders %}
                                            <div class="row table-like-row">
                                                <div class="image-col cell col-md-2 align-items-center border-bottom text-center ">
                                                    {% if order.auction.get_image %}
                                                        <img src="{{ order.auction.get_image.image.url }}"
                                                             alt="{{ order.auction.title }}"
                                                             class="img-fluid">
                                                    {% else %}
                                                        <img src="{% static 'images/no_image.png' %}" alt="No Image"
                                                             class="img-fluid">
                                                    {% endif %}
                                                </div>
                                                <div class="cell col-md-7 align-items-center border-bottom">
                                                    <strong>Product:</strong> {{ order.auction.title }}<br>
                                                    <strong>Status:</strong> {{ order.status|capfirst }}<br>
                                                    <strong>Ordered:</strong> {{ order.created_at }}<br>
                                                    <strong>Order ID:</strong> {{ order.id }}<br>

                                                    {% if order.order_note %}
                                                        <strong>Order Note:</strong> {{ order.order_note }}<br>
                                                    {% endif %}
                                                </div>
                                                <div class="cell col-md-3 d-grid gap-2 w-100 border-bottom">
                                                    <button class="btn btn-info btn-sm w-100 mb-2"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#orderModal{{ order.id }}">View Details
                                                    </button>

                                                    <button type="button" class="btn btn-warning btn-sm w-100 mb-2"
                                                            id="question-icon-{{ order.auction.id }}"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#questionModal-{{ order.auction.id }}"
                                                            title="Ask a Question">
                                                        Ask a Question
                                                    </button>

                                                    <button class="btn btn-secondary btn-sm w-100"
                                                            id="noteBtn{{ order.id }}"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#noteModal{{ order.id }}">
                                                        Add Note
                                                    </button>
                                                </div>

                                            </div>



                                            <!-- Ask a Question / Contact Customer Service Modal -->
                                            <div class="modal fade" id="questionModal-{{ order.auction.id }}"
                                                 tabindex="-1"
                                                 aria-labelledby="questionModalLabel-{{ order.auction.id }}"
                                                 aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <form id="generalMessageForm-{{ order.auction.id }}"
                                                              class="questionForm" method="POST"
                                                              action="{% url 'send_message' order.auction.id %}">
                                                            {% csrf_token %}
                                                            <div class="modal-header">
                                                                <h5 class="modal-title"
                                                                    id="questionModalLabel-{{ order.auction.id }}">
                                                                    New Message
                                                                </h5>
                                                                <button type="button" class="btn-close"
                                                                        data-bs-dismiss="modal"
                                                                        aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="mb-3">
                                                                    <label for="recipient-{{ order.auction.id }}"
                                                                           class="form-label">Send to</label>
                                                                    <select id="recipient-{{ order.auction.id }}"
                                                                            class="form-select" name="recipient">
                                                                        <option value="seller">Seller</option>
                                                                        <option value="customer_service">Customer
                                                                            Service
                                                                        </option>
                                                                    </select>
                                                                </div>
                                                                <div id="order-info-{{ order.auction.id }}"
                                                                     class="mb-3">
                                                                    <label for="subject-{{ order.auction.id }}"
                                                                           class="form-label">Subject</label>
                                                                    <input type="text" name="subject"
                                                                           id="subject-{{ order.auction.id }}"
                                                                           class="form-control"
                                                                           value="Question About Order #{{ order.id }}, {{ order.auction.title }}">
                                                                </div>
                                                                <div class="mb-3">
                                                                    <label for="message-body-{{ order.auction.id }}"
                                                                           class="form-label">Message</label>
                                                                    <textarea name="body"
                                                                              id="message-body-{{ order.auction.id }}"
                                                                              class="form-control" rows="5"
                                                                              placeholder="Describe your issue..."
                                                                              maxlength="1000"></textarea>
                                                                    <small id="charCount-{{ order.auction.id }}"
                                                                           class="form-text text-muted text-end">0/1000
                                                                        characters used</small>
                                                                </div>
                                                                <div id="guardrails-{{ order.auction.id }}"
                                                                     class="alert alert-info" role="alert">
                                                                    For questions about the order status, contact
                                                                    Customer Service. For questions specifically about
                                                                    the product, contact the Seller.
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-secondary"
                                                                        data-bs-dismiss="modal">Close
                                                                </button>
                                                                <button type="submit" class="btn btn-primary">Send
                                                                    Message
                                                                </button>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>


                                            <!-- Add Note Modal -->
                                            <div class="modal fade" id="noteModal{{ order.id }}"
                                                 tabindex="-1"
                                                 aria-labelledby="noteModalLabel{{ order.id }}"
                                                 aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered modal-sm">
                                                    <div class="modal-content"
                                                         style="border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title"
                                                                id="noteModalLabel{{ order.id }}">Add
                                                                Note</h5>
                                                            <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal"
                                                                    aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <form method="post"
                                                                  action="{% url 'add_order_note' order.id %}">
                                                                {% csrf_token %}
                                                                <div class="mb-3">
                                                                    <label for="orderNote{{ order.id }}"
                                                                           class="form-label">Order
                                                                        Notes:</label>
                                                                    {% with form=note_forms|get_item:order.id %}
                                                                        {{ form.order_note }}
                                                                        {% if form.order_note.errors %}
                                                                            <div class="text-danger">
                                                                                {{ form.order_note.errors }}
                                                                            </div>
                                                                        {% endif %}
                                                                    {% endwith %}
                                                                </div>
                                                                <button type="submit"
                                                                        class="btn btn-primary btn-sm">Save Note
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Order Details Modal -->
                                            <div class="modal fade" id="orderModal{{ order.id }}" tabindex="-1"
                                                 aria-labelledby="orderModalLabel{{ order.id }}" aria-hidden="true">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title"
                                                                id="orderModalLabel{{ order.id }}">
                                                                {{ order.auction.title }} - Order Details</h5>
                                                            <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal"
                                                                    aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <!-- Order Progress Bar -->
                                                            <div class="progress mb-4">
                                                                {% if order.status == 'pending' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                                         role="progressbar"
                                                                         style="width: 25%;" aria-valuenow="25"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Pending
                                                                    </div>
                                                                {% elif order.status == 'processing' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-info"
                                                                         role="progressbar"
                                                                         style="width: 50%;" aria-valuenow="50"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Processing
                                                                    </div>
                                                                {% elif order.status == 'shipped' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                                                                         role="progressbar"
                                                                         style="width: 75%;" aria-valuenow="75"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Shipped
                                                                    </div>
                                                                {% elif order.status == 'completed' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                                                         role="progressbar"
                                                                         style="width: 100%;" aria-valuenow="100"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Complete
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                            <!-- Order Details Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Order Details</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <dl class="row">
                                                                        <dt class="col-sm-4">Order Number</dt>
                                                                        <dd class="col-sm-8">{{ order.id }}</dd>

                                                                        <dt class="col-sm-4">Order Placed</dt>
                                                                        <dd class="col-sm-8">{{ order.created_at }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                            <!-- Shipping Info Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Shipping Info</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <dl class="row">
                                                                        <dt class="col-sm-4">Shipping Address</dt>
                                                                        <dd class="col-sm-8">
                                                                            {{ order.shipping_address.shipping_full_name }}<br>
                                                                            {{ order.shipping_address.shipping_street_address }}, {{ order.shipping_address.shipping_apartment_suite|default:"" }}<br>
                                                                            {{ order.shipping_address.shipping_city }}, {{ order.shipping_address.shipping_state }} {{ order.shipping_address.shipping_zip_code }}<br>
                                                                            {{ order.shipping_address.shipping_country }}<br>
                                                                            {{ order.shipping_address.shipping_phone_number }}
                                                                        </dd>

                                                                        <dt class="col-sm-4">Shipping Method</dt>
                                                                        <dd class="col-sm-8">{{ order.shipping_method|capfirst }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>


                                                            <!-- Items Ordered Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Items Ordered</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="row font-weight-bold border-bottom">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6">Item</div>
                                                                        <div class="col-md-2">Quantity</div>
                                                                        <div class="col-md-2">Price</div>
                                                                    </div>
                                                                    {% for item in order.items.all %}
                                                                        <div class="row align-items-center border-bottom py-2">
                                                                            <div class="col-md-2">
                                                                                {% if item.auction.get_image %}
                                                                                    <img src="{{ item.auction.get_image.image.url }}"
                                                                                         alt="{{ item.auction.title }}"
                                                                                         style="width: 80px; height: 80px; object-fit: cover;">
                                                                                {% else %}
                                                                                    <img src="{% static 'images/no_image.png' %}"
                                                                                         alt="No Image"
                                                                                         style="width: 80px; height: 80px; object-fit: cover;">
                                                                                {% endif %}
                                                                            </div>

                                                                            <div class="col-md-6">
                                                                                {{ item.auction.title }}
                                                                            </div>
                                                                            <div class="col-md-2">
                                                                                {{ item.quantity }}
                                                                            </div>
                                                                            <div class="col-md-2">
                                                                                ${{ item.price }}
                                                                            </div>
                                                                        </div>
                                                                    {% endfor %}
                                                                    <dl class="row mb-0">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6"></div>
                                                                        <dt class="col-md-2">Shipping</dt>
                                                                        <dd class="col-md-2">
                                                                            {% if order.carriers.exists %}
                                                                                $
                                                                                {{ order.carriers.first.shipping_cost }}
                                                                            {% else %}
                                                                                $0.00
                                                                            {% endif %}
                                                                        </dd>
                                                                    </dl>
                                                                    <dl class="row mb-0">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6"></div>
                                                                        <dt class="col-md-2">Tax</dt>
                                                                        <dd class="col-md-2">
                                                                            {% if order.tax_amount %}
                                                                                $
                                                                                {{ order.carriers.first.shipping_cost }}
                                                                            {% else %}
                                                                                $0.00
                                                                            {% endif %}
                                                                        </dd>
                                                                    </dl>
                                                                    <dl class="row mb-0">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6"></div>
                                                                        <dt class="col-md-2">Total</dt>
                                                                        <dd class="col-md-2 fw-bold">
                                                                            ${{ order.total_amount }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>


                                                            <!-- Delivery Info Section -->
                                                            <div class="card">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Delivery Info</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    {% if order.carriers %}
                                                                        <dl class="row">
                                                                            <dt class="col-sm-4">Carrier</dt>
                                                                            <dd class="col-sm-8">
                                                                                {% if order.carriers.exists %}
                                                                                    {{ order.carriers.first.carrier }}
                                                                                    -
                                                                                    {{ order.carriers.first.delivery_method }}
                                                                                {% else %}
                                                                                    No carrier assigned
                                                                                {% endif %}
                                                                            </dd>

                                                                            {#                                                            <dt class="col-sm-4">Shipping Cost</dt>#}
                                                                            {#                                                            <dd class="col-sm-8">#}
                                                                            {#                                                                {% if order.carriers.exists %}#}
                                                                            {#                                                                    ${{ order.carriers.first.shipping_cost }}#}
                                                                            {#                                                                {% else %}#}
                                                                            {#                                                                    N/A#}
                                                                            {#                                                                {% endif %}#}
                                                                            {#                                                            </dd>#}
                                                                            <dt class="col-sm-4">Tracking
                                                                                Number(s)
                                                                            </dt>
                                                                            <dd class="col-sm-8">
                                                                                <div>
                                                                                    {% for parcel in order.parcels.all %}
                                                                                        <div class="mb-2">
                                                                                            Tracking
                                                                                            Number: {{ parcel.tracking_number }}<br>
                                                                                            Status: {{ parcel.delivery_status|capfirst }}<br>
                                                                                            Dimensions: {{ parcel.length }}
                                                                                            x {{ parcel.width }}
                                                                                            x {{ parcel.height }}<br>
                                                                                            Weight: {{ parcel.weight }}
                                                                                            lbs
                                                                                            <div class="progress mb-4">
                                                                                                {% if parcel.delivery_status == 'pending' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                                                                         role="progressbar"
                                                                                                         style="width: 25%;"
                                                                                                         aria-valuenow="25"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Pending
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'shipped' or parcel.delivery_status == 'in_transit' or parcel.delivery_status == 'out_for_delivery' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                                                                                                         role="progressbar"
                                                                                                         style="width: 50%;"
                                                                                                         aria-valuenow="50"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Shipped
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'delivered' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                                                                                         role="progressbar"
                                                                                                         style="width: 100%;"
                                                                                                         aria-valuenow="100"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Delivered
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'delayed' or parcel.delivery_status == 'failed_attempt' or parcel.delivery_status == 'returned_to_sender' or parcel.delivery_status == 'held_at_location' or parcel.delivery_status == 'exception' or parcel.delivery_status == 'cancelled' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger"
                                                                                                         role="progressbar"
                                                                                                         style="width: 75%;"
                                                                                                         aria-valuenow="75"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Issues
                                                                                                    </div>
                                                                                                {% endif %}
                                                                                            </div>
                                                                                        </div>
                                                                                    {% endfor %}
                                                                                </div>
                                                                            </dd>
                                                                        </dl>
                                                                    {% endif %}
                                                                </div>
                                                            </div>


                                                        </div>
                                                        <div class="modal-footer bg-light">
                                                            <button type="button" class="btn btn-secondary"
                                                                    data-bs-dismiss="modal">
                                                                Close
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                        {% empty %}
                                            <div class="row">
                                                <div>No orders found.</div>
                                            </div>
                                        {% endfor %}


                                    </div>


                                    {% if orders.has_other_pages %}
                                        <div class='d-flex justify-content-center'>
                                            <ul class='pagination'>

                                                <!-- Previous Page Link -->
                                                {% if orders.has_previous %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?order_page={{ orders.previous_page_number }}&active_tab=orders&order_status={{ order_status }}&order_date={{ order_date }}'>
                                                            &laquo;
                                                        </a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&laquo;</a>
                                                    </li>
                                                {% endif %}

                                                <!-- First Page Link -->
                                                {% if orders.number > 3 %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?order_page=1&active_tab=orders&order_status={{ order_status }}&order_date={{ order_date }}'>1</a>
                                                    </li>
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Page Range Around Current Page -->
                                                {% for i in orders.paginator.page_range %}
                                                    {% if i >= orders.number|add:'-2' and i <= orders.number|add:'2' %}
                                                        {% if orders.number == i %}
                                                            <li class='page-item active'>
                                                                <a class='page-link' href='#'>{{ i }}</a>
                                                            </li>
                                                        {% else %}
                                                            <li class='page-item'>
                                                                <a class='page-link'
                                                                   href='?order_page={{ i }}&active_tab=orders&order_status={{ order_status }}&order_date={{ order_date }}'>{{ i }}</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}

                                                <!-- Last Page Link -->
                                                {% if orders.number < orders.paginator.num_pages|add:'-2' %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?order_page={{ orders.paginator.num_pages }}&active_tab=orders&order_status={{ order_status }}&order_date={{ order_date }}'>{{ orders.paginator.num_pages }}</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Next Page Link -->
                                                {% if orders.has_next %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?order_page={{ orders.next_page_number }}&active_tab=orders&order_status={{ order_status }}&order_date={{ order_date }}'>&raquo;</a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&raquo;</a>
                                                    </li>
                                                {% endif %}

                                            </ul>
                                        </div>
                                    {% endif %}

                                </div>
                            </div>

                        </div>

                        <!-- My Sales Tab -->
                        <div class="tab-pane fade{% if active_tab == 'sales' %}show active{% endif %}" id="sales"
                             role="tabpanel" aria-labelledby="sales-tab">
                            <!-- My Sales -->
                            <div class='my-2 border-top'>
                                <div class='card-header d-flex justify-content-between align-items-center'>
                                    <div>
                                        <i class='fas fa-table me-1'></i>
                                        {{ sales_status|capfirst }} Sales
                                    </div>
                                    <div class="filter-container">
                                        <!-- Filter Button for Mobile -->
                                        <button class="btn btn-primary d-md-none" type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#filterCollapseSales" aria-expanded="false"
                                                aria-controls="filterCollapseSales" aria-label="Toggle Filter">
                                            <i class="fas fa-filter me-1"></i> Filter
                                        </button>

                                        <!-- Filter Form -->
                                        <div class="collapse d-md-block" id="filterCollapseSales">
                                            <form method="GET"
                                                  class="d-flex flex-column flex-md-row align-items-md-center mt-3 mt-md-0">
                                                <input type="hidden" name="active_tab" value="sales">

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="sales_status" class="form-select">
                                                        <option value="">All Sales</option>
                                                        <option value="pending"
                                                                {% if sales_status == 'pending' %}selected{% endif %}>
                                                            Pending
                                                        </option>
                                                        <option value="processing"
                                                                {% if sales_status == 'processing' %}selected{% endif %}>
                                                            Processing
                                                        </option>
                                                        <option value="shipped"
                                                                {% if sales_status == 'shipped' %}selected{% endif %}>
                                                            Shipped
                                                        </option>
                                                        <option value="completed"
                                                                {% if sales_status == 'completed' %}selected{% endif %}>
                                                            Completed
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <input type="date" name="sales_date" class="form-control"
                                                           value="{{ request.GET.sales_date }}">
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <button type="submit" class="btn btn-primary">Filter</button>
                                                </div>

                                                {% if sales_status != 'All' %}
                                                    <div class="input-group">
                                                        <a href="{% url 'dashboard' %}?active_tab=sales&sales_status=&sales_date="
                                                           class="btn btn-secondary">Reset</a>
                                                    </div>
                                                {% endif %}
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <div class='card-body'>
                                    <div class="table-like" id="table-like">
                                        <div class="row header table-like-row">
                                            <div class="cell col-md-2 image-col"></div>
                                            <div class="cell col-md-7">Sales Details</div>
                                            <div class="cell col-md-3 align-items-center">Actions</div>
                                        </div>

                                        {% for sale in sales %}
                                            <div class="row table-like-row">
                                                <div class="image-col cell col-md-2 align-items-center border-bottom text-center">
                                                    {% if sale.auction.get_image %}
                                                        <img src="{{ sale.auction.get_image.image.url }}"
                                                             alt="{{ sale.auction.title }}"
                                                             class="img-fluid">
                                                    {% else %}
                                                        <img src="{% static 'images/no_image.png' %}" alt="No Image"
                                                             class="img-fluid">
                                                    {% endif %}
                                                </div>
                                                <div class="cell col-md-7 align-items-center border-bottom">
                                                    <strong>Product:</strong> {{ sale.auction.title }}<br>
                                                    <strong>Status:</strong> {{ sale.status|capfirst }}<br>
                                                    <strong>Sold On:</strong> {{ sale.created_at }}<br>
                                                    <strong>Sale ID:</strong> {{ sale.id }}<br>
                                                </div>
                                                <div class="cell col-md-3 gap-2 w-100 border-bottom">
                                                    <button class="btn btn-info btn-sm w-100 mb-2"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#saleModal{{ sale.id }}">View Details
                                                    </button>
                                                </div>
                                            </div>

                                            <!-- Sale Details Modal -->
                                            <div class="modal fade" id="saleModal{{ sale.id }}" tabindex="-1"
                                                 aria-labelledby="saleModalLabel{{ sale.id }}" aria-hidden="true">
                                                <div class="modal-dialog modal-lg">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="saleModalLabel{{ sale.id }}">
                                                                {{ sale.auction.title }} - Sale Details</h5>
                                                            <button type="button" class="btn-close"
                                                                    data-bs-dismiss="modal"
                                                                    aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <!-- Sale Progress Bar -->
                                                            <div class="progress mb-4">
                                                                {% if sale.status == 'pending' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                                         role="progressbar"
                                                                         style="width: 25%;" aria-valuenow="25"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Pending
                                                                    </div>
                                                                {% elif sale.status == 'processing' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-info"
                                                                         role="progressbar"
                                                                         style="width: 50%;" aria-valuenow="50"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Processing
                                                                    </div>
                                                                {% elif sale.status == 'shipped' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                                                                         role="progressbar"
                                                                         style="width: 75%;" aria-valuenow="75"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Shipped
                                                                    </div>
                                                                {% elif sale.status == 'completed' %}
                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                                                         role="progressbar"
                                                                         style="width: 100%;" aria-valuenow="100"
                                                                         aria-valuemin="0"
                                                                         aria-valuemax="100">
                                                                        Complete
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                            <!-- Sale Details Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Sale Details</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <dl class="row">
                                                                        <dt class="col-sm-4">Sale Number</dt>
                                                                        <dd class="col-sm-8">{{ sale.id }}</dd>

                                                                        <dt class="col-sm-4">Sold On</dt>
                                                                        <dd class="col-sm-8">{{ sale.created_at }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                            <!-- Shipping Info Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Shipping Info</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <dl class="row">
                                                                        <dt class="col-sm-4">Shipping Address</dt>
                                                                        <dd class="col-sm-8">
                                                                            {{ sale.shipping_address.shipping_full_name }}<br>
                                                                            {{ sale.shipping_address.shipping_street_address }}, {{ sale.shipping_address.shipping_apartment_suite|default:"" }}<br>
                                                                            {{ sale.shipping_address.shipping_city }}, {{ sale.shipping_address.shipping_state }} {{ sale.shipping_address.shipping_zip_code }}<br>
                                                                            {{ sale.shipping_address.shipping_country }}<br>
                                                                            {{ sale.shipping_address.shipping_phone_number }}
                                                                        </dd>

                                                                        <dt class="col-sm-4">Shipping Method</dt>
                                                                        <dd class="col-sm-8">{{ sale.shipping_method|capfirst }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                            <!-- Items Sold Section -->
                                                            <div class="card mb-3">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Items Sold</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    <div class="row font-weight-bold border-bottom">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6">Item</div>
                                                                        <div class="col-md-2">Quantity</div>
                                                                        <div class="col-md-2">Price</div>
                                                                    </div>
                                                                    {% for item in sale.items.all %}
                                                                        <div class="row align-items-center border-bottom py-2">
                                                                            <div class="col-md-2">
                                                                                {% if item.auction.get_image %}
                                                                                    <img src="{{ item.auction.get_image.image.url }}"
                                                                                         alt="{{ item.auction.title }}"
                                                                                         style="width: 80px; height: 80px; object-fit: cover;">
                                                                                {% else %}
                                                                                    <img src="{% static 'images/no_image.png' %}"
                                                                                         alt="No Image"
                                                                                         style="width: 80px; height: 80px; object-fit: cover;">
                                                                                {% endif %}
                                                                            </div>

                                                                            <div class="col-md-6">
                                                                                {{ item.auction.title }}
                                                                            </div>
                                                                            <div class="col-md-2">
                                                                                {{ item.quantity }}
                                                                            </div>
                                                                            <div class="col-md-2">
                                                                                ${{ item.price }}
                                                                            </div>
                                                                        </div>
                                                                    {% endfor %}
                                                                    <dl class="row mb-0">
                                                                        <div class="col-md-2"></div>
                                                                        <div class="col-md-6"></div>
                                                                        <dt class="col-md-2">Total</dt>
                                                                        <dd class="col-md-2 fw-bold">
                                                                            ${{ sale.total_amount }}</dd>
                                                                    </dl>
                                                                </div>
                                                            </div>

                                                            <!-- Delivery Info Section -->
                                                            <div class="card">
                                                                <div class="card-header bg-light">
                                                                    <h4 class="mb-0">Delivery Info</h4>
                                                                </div>
                                                                <div class="card-body">
                                                                    {% if sale.carriers %}
                                                                        <dl class="row">
                                                                            <dt class="col-sm-4">Carrier</dt>
                                                                            <dd class="col-sm-8">
                                                                                {% if sale.carriers.exists %}
                                                                                    {{ sale.carriers.first.carrier }} -
                                                                                    {{ sale.carriers.first.delivery_method }}
                                                                                {% else %}
                                                                                    No carrier assigned
                                                                                {% endif %}
                                                                            </dd>

                                                                            <dt class="col-sm-4">Tracking Number(s)</dt>
                                                                            <dd class="col-sm-8">
                                                                                <div>
                                                                                    {% for parcel in sale.parcels.all %}
                                                                                        <div class="mb-2">
                                                                                            Tracking
                                                                                            Number: {{ parcel.tracking_number }}<br>
                                                                                            Status: {{ parcel.delivery_status|capfirst }}<br>
                                                                                            Dimensions: {{ parcel.length }}
                                                                                            x {{ parcel.width }}
                                                                                            x {{ parcel.height }}<br>
                                                                                            Weight: {{ parcel.weight }}
                                                                                            lbs
                                                                                            <div class="progress mb-4">
                                                                                                {% if parcel.delivery_status == 'pending' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                                                                         role="progressbar"
                                                                                                         style="width: 25%;"
                                                                                                         aria-valuenow="25"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Pending
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'shipped' or parcel.delivery_status == 'in_transit' or parcel.delivery_status == 'out_for_delivery' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                                                                                                         role="progressbar"
                                                                                                         style="width: 50%;"
                                                                                                         aria-valuenow="50"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Shipped
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'delivered' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                                                                                         role="progressbar"
                                                                                                         style="width: 100%;"
                                                                                                         aria-valuenow="100"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Delivered
                                                                                                    </div>
                                                                                                {% elif parcel.delivery_status == 'delayed' or parcel.delivery_status == 'failed_attempt' or parcel.delivery_status == 'returned_to_sender' or parcel.delivery_status == 'held_at_location' or parcel.delivery_status == 'exception' or parcel.delivery_status == 'cancelled' %}
                                                                                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-danger"
                                                                                                         role="progressbar"
                                                                                                         style="width: 75%;"
                                                                                                         aria-valuenow="75"
                                                                                                         aria-valuemin="0"
                                                                                                         aria-valuemax="100">
                                                                                                        Issues
                                                                                                    </div>
                                                                                                {% endif %}
                                                                                            </div>
                                                                                        </div>
                                                                                    {% endfor %}
                                                                                </div>
                                                                            </dd>
                                                                        </dl>
                                                                    {% endif %}
                                                                </div>
                                                            </div>

                                                        </div>
                                                        <div class="modal-footer bg-light">
                                                            <button type="button" class="btn btn-secondary"
                                                                    data-bs-dismiss="modal">
                                                                Close
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        {% empty %}
                                            <tr>
                                                <td colspan="3">No sales found.</td>
                                            </tr>
                                        {% endfor %}

                                    </div>

                                    {% if sales.has_other_pages %}
                                        <div class='d-flex justify-content-center'>
                                            <ul class='pagination flex-wrap justify-content-center'>

                                                <!-- Previous Page Link -->
                                                {% if sales.has_previous %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?sale_page={{ sales.previous_page_number }}&active_tab=sales&sales_status={{ sales_status }}&sales_date={{ sales_date }}'>
                                                            &laquo;
                                                        </a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&laquo;</a>
                                                    </li>
                                                {% endif %}

                                                <!-- First Page Link and Ellipsis -->
                                                {% if sales.number > 3 %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?sale_page=1&active_tab=sales&sales_status={{ sales_status }}&sales_date={{ sales_date }}'>1</a>
                                                    </li>
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Page Range Around Current Page -->
                                                {% for i in sales.paginator.page_range %}
                                                    {% if i >= sales.number|add:'-2' and i <= sales.number|add:'2' %}
                                                        {% if sales.number == i %}
                                                            <li class='page-item active'>
                                                                <a class='page-link' href='#'>{{ i }}</a>
                                                            </li>
                                                        {% else %}
                                                            <li class='page-item'>
                                                                <a class='page-link'
                                                                   href='?sale_page={{ i }}&active_tab=sales&sales_status={{ sales_status }}&sales_date={{ sales_date }}'>{{ i }}</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}

                                                <!-- Last Page Link and Ellipsis -->
                                                {% if sales.number < sales.paginator.num_pages|add:'-2' %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?sale_page={{ sales.paginator.num_pages }}&active_tab=sales&sales_status={{ sales_status }}&sales_date={{ sales_date }}'>{{ sales.paginator.num_pages }}</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Next Page Link -->
                                                {% if sales.has_next %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?sale_page={{ sales.next_page_number }}&active_tab=sales&sales_status={{ sales_status }}&sales_date={{ sales_date }}'>&raquo;</a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&raquo;</a>
                                                    </li>
                                                {% endif %}

                                            </ul>
                                        </div>
                                    {% endif %}

                                </div>
                            </div>
                        </div>

                        <!-- My Active Bids Tab -->
                        <div class="tab-pane fade {% if active_tab == 'active' %}show active{% endif %}"
                             id="myActiveBids"
                             role="tabpanel" aria-labelledby="my-bids-tab">

                            <div class='my-2 border-top'>
                                <div class='card-header d-flex justify-content-between align-items-center'>
                                    <div>
                                        <i class='fas fa-gavel me-1'></i>
                                        {{ bid_status|capfirst }} Active Bids
                                    </div>
                                    <div class="filter-container">
                                        <!-- Filter Button for Mobile -->
                                        <button class="btn btn-primary d-md-none" type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#filterCollapseBids" aria-expanded="false"
                                                aria-controls="filterCollapseBids" aria-label="Toggle Filter">
                                            <i class="fas fa-filter me-1"></i> Filter
                                        </button>

                                        <!-- Filter Form -->
                                        <div class="collapse d-md-block" id="filterCollapseBids">
                                            <form method="GET"
                                                  class="d-flex flex-column flex-md-row align-items-md-center mt-3 mt-md-0">
                                                <input type="hidden" name="active_tab" value="activeBids">

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="bid_status" class="form-select">
                                                        <option value="">All Bids</option>
                                                        <option value="highest"
                                                                {% if bid_status == 'highest' %}selected{% endif %}>
                                                            Highest
                                                            Bids
                                                        </option>
                                                        <option value="outbid"
                                                                {% if bid_status == 'outbid' %}selected{% endif %}>
                                                            Outbid
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <button type="submit" class="btn btn-primary">Filter</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                <div class='card-body'>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                            <tr>
                                                <th>Auction Title</th>
                                                <th>Expiring In</th>
                                                <th>Highest Bid</th>
                                                <th>Your Bid</th>
                                                <th>Is Highest Bidder</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for auction in auctions %}
                                                <tr>
                                                    <td>
                                                        <a href="{% url 'active_auctions_with_id' auction.id %}">
                                                            {{ auction.manufacturer }} - {{ auction.title }}
                                                        </a>
                                                    </td>
                                                    <td>
                                                        <div class="lead time-remaining">{{ auction.formatted_time_remaining }}</div>
                                                    </td>
                                                    <td>{{ auction.highest_bid }}</td>
                                                    <td>{{ auction.user_highest_bid }}</td>
                                                    <td>{{ auction.user_is_highest_bidder|yesno:"Yes,No" }}</td>
                                                </tr>
                                            {% empty %}
                                                <tr>
                                                    <td colspan="5">No active bids found.</td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>


                                    {% if auctions.has_other_pages %}
                                        <div class='d-flex justify-content-center'>
                                            <ul class='pagination flex-wrap justify-content-center'>

                                                <!-- Previous Page Link -->
                                                {% if auctions.has_previous %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?auction_page={{ auctions.previous_page_number }}'>&laquo;</a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&laquo;</a>
                                                    </li>
                                                {% endif %}

                                                <!-- First Page Link and Ellipsis -->
                                                {% if auctions.number > 3 %}
                                                    <li class='page-item'>
                                                        <a class='page-link' href='?auction_page=1'>1</a>
                                                    </li>
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Page Range Around Current Page -->
                                                {% for i in auctions.paginator.page_range %}
                                                    {% if i >= auctions.number|add:'-2' and i <= auctions.number|add:'2' %}
                                                        {% if auctions.number == i %}
                                                            <li class='page-item active'>
                                                                <a class='page-link' href='#'>{{ i }}</a>
                                                            </li>
                                                        {% else %}
                                                            <li class='page-item'>
                                                                <a class='page-link'
                                                                   href='?auction_page={{ i }}'>{{ i }}</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}

                                                <!-- Last Page Link and Ellipsis -->
                                                {% if auctions.number < auctions.paginator.num_pages|add:'-2' %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?auction_page={{ auctions.paginator.num_pages }}'>{{ auctions.paginator.num_pages }}</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Next Page Link -->
                                                {% if auctions.has_next %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?auction_page={{ auctions.next_page_number }}'>&raquo;</a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&raquo;</a>
                                                    </li>
                                                {% endif %}

                                            </ul>
                                        </div>
                                    {% endif %}

                                </div>
                            </div>
                        </div>

                        <!-- My Listings -->
                        <div class="tab-pane fade {% if active_tab == 'listings' %}show active{% endif %}"
                             id="listings"
                             role="tabpanel" aria-labelledby="listings-tab">

                            <div class='my-2 border-top'>
                                <div class='card-header d-flex justify-content-between align-items-center'>
                                    <div class="d-flex align-items-center">
                                        <i class='fas fa-gavel me-1'></i>
                                        {% if listing_status %}
                                            {{ listing_status|capfirst }} Listings
                                        {% else %}
                                            All Listings
                                        {% endif %}
                                        
                                        
                                        <button type="button" id="post-selected-listings" class="btn btn-warning ms-3"
                                                style="display: none;">Post All Listings
                                        </button>
                                    </div>
                                    <div class="filter-container">
                                        <!-- Filter Button for Mobile -->
                                        <button class="btn btn-primary d-md-none" type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#filterCollapseListings" aria-expanded="false"
                                                aria-controls="filterCollapseListings" aria-label="Toggle Filter">
                                            <i class="fas fa-filter me-1"></i> Filter
                                        </button>

                                        <!-- Filter Form -->
                                        <div class="collapse d-md-block" id="filterCollapseListings">
                                            <form method="GET"
                                                  class="d-flex flex-column flex-md-row align-items-md-center mt-3 mt-md-0">
                                                <input type="hidden" name="active_tab" value="listings">

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="listing_status" class="form-select">
                                                        <option value="">All Listings</option>
                                                        <option value="active"
                                                                {% if listing_status == 'active' %}selected{% endif %}>
                                                            Active
                                                        </option>
                                                        <option value="inactive"
                                                                {% if listing_status == 'inactive' %}selected{% endif %}>
                                                            Inactive
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="hold_for_import" class="form-select">
                                                        <option value="False"
                                                                {% if hold_for_import == False or hold_for_import == '' %}selected{% endif %}>
                                                            Not On Hold
                                                        </option>
                                                        <option value="True"
                                                                {% if hold_for_import %}selected{% endif %}>On
                                                            Hold
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <select name="listing_type" class="form-select">
                                                        <option value="">Listings Type</option>
                                                        <option value="Auction"
                                                                {% if listing_type == 'Auction' %}selected{% endif %}>
                                                            Auction
                                                        </option>
                                                        <option value="Sale"
                                                                {% if listing_type == 'Sale' %}selected{% endif %}>Sale
                                                        </option>
                                                    </select>
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <input type="date" name="listing_date" class="form-control"
                                                           value="{{ request.GET.listing_date }}">
                                                </div>

                                                <div class="input-group me-md-2 mb-2 mb-md-0">
                                                    <button type="submit" class="btn btn-primary">Filter</button>
                                                </div>

                                                {% if listing_status %}
                                                    <div class="input-group">
                                                        <a href="{% url 'dashboard' %}?active_tab=listings&listing_status=&hold_for_import=&listing_type=&listing_date="
                                                           class="btn btn-secondary">Reset</a>
                                                    </div>
                                                {% endif %}
                                            </form>
                                        </div>
                                    </div>
                                </div>

                                <div class='card-body'>
                                    <div class="table-like" id="table-like">
                                        <div class="row header table-like-row">
                                            {% if hold_for_import %}
                                                <div class="cell col-auto d-flex d-inline-flex align-items-center">
                                                    <div style=" display: flex; align-items: center; justify-content: center;">
                                                        <input class="form-check-input m-0" type="checkbox"
                                                               id="select-all-listings">
                                                        <label for="select-all-listings" class="text-nowrap ms-2 mb-0">Select
                                                            All</label>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            <div class="cell col-md-2 image-col">
                                                <div style=" display: flex; align-items: center; justify-content: center;">
                                                    Image
                                                </div>
                                            </div>
                                            <div class="cell col-md-6">Listing Details</div>
                                            <div class="cell col-md-3 align-items-center">Actions</div>
                                        </div>
                                        <div class="row">

                                        </div>

                                        {% for listing in listings %}
                                            <!-- Listing Row -->
                                            <div class="row table-like-row">
                                                {% if hold_for_import %}
                                                    <div class="cell d-flex col-auto align-items-center text-center">
                                                        <input class="form-check-input listing-checkbox" type="checkbox"
                                                               data-listing-id="{{ listing.id }}">
                                                    </div>
                                                {% endif %}
                                                <div class="image-col cell col-md-2 align-items-center text-center">
                                                    {% if listing.get_image %}
                                                        <img src="{{ listing.get_image.image.url }}"
                                                             alt="{{ listing.title }}"
                                                             class="img-fluid">
                                                    {% else %}
                                                        <img src="{% static 'images/no_image.png' %}" alt="No Image"
                                                             class="img-fluid">
                                                    {% endif %}
                                                </div>
                                                <div class="cell col-md-6 align-items-center ">
                                                    <strong>Product:</strong> {{ listing.title }}<br>
                                                    <strong>Status:</strong> {{ listing.active|yesno:"Active,Inactive" }}<br>
                                                    <strong>Listed On:</strong> {{ listing.date_created }}<br>
                                                    <strong>Listed Type:</strong> {{ listing.auction_type }}<br>
                                                    <strong>Listing ID:</strong> {{ listing.id }}<br>
                                                </div>

                                                <div class="cell col-md-3 gap-2 w-100">
                                                    <button class="btn btn-info btn-sm w-100 mb-2"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#listingModal{{ listing.id }}"
                                                            data-auction-id="{{ listing.id }}">
                                                        View Details
                                                    </button>
                                                    {% if listing.active %}
                                                        <a href="{% url 'auction_close' listing.id %}"
                                                           class="btn btn-danger btn-sm w-100 mb-2">Close Listing
                                                        </a>
                                                    {% endif %}
                                                    {% if listing.active == 'False' and listing.hold_for_import == 'False' %}
                                                        <a href="{% url 'auction_relist' listing.id %}"
                                                           class="btn btn-primary btn-sm w-100">Relist
                                                            {% if listing.auction_type == 'Auction' %}For
                                                                Auction{% else %}For Sale{% endif %} </a>
                                                    {% endif %}

                                                    {% if listing.hold_for_import %}

                                                        <button type="button" class="btn btn-warning btn-sm w-100"
                                                                onclick="confirmListing({{ listing.id }}, '{{ listing.auction_type }}, {{ active_tab }}, {{ listing_status }}, {{ listing_type }}, {{ listing_date }}, {{ hold_for_import }}')">
                                                            List {% if listing.auction_type == 'Auction' %}For
                                                            Auction{% else %}For Sale{% endif %}
                                                        </button>
                                                    {% endif %}
                                                </div>
                                            </div>

                                            <!-- Listing Details Modal -->
                                            <div class="modal fade listingModal" id="listingModal{{ listing.id }}"
                                                 tabindex="-1"
                                                 aria-labelledby="listingModalLabel{{ listing.id }}" aria-hidden="true">
                                                <form id="editAuctionForm{{ listing.id }}" method="post"
                                                      action="{% url 'edit_auction' listing.id %}">
                                                    {% csrf_token %}
                                                    <!-- Hidden Inputs -->
                                                    <input class="form-control readonly-input"
                                                           type="text"
                                                           name="{{ listing.edit_form.auction_type.html_name }}"
                                                           id="{{ listing.edit_form.auction_type.id_for_label }}"
                                                           value="{{ listing.edit_form.auction_type.value }}"
                                                           readonly hidden>

                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title w-100"
                                                                    id="listingModalLabel{{ listing.id }}">
                                                                    <input class="form-control readonly-input fs-5 w-100"
                                                                           type="text"
                                                                           name="{{ listing.edit_form.title.html_name }}"
                                                                           id="{{ listing.edit_form.title.id_for_label }}"
                                                                           value="{{ listing.edit_form.title.value }}"
                                                                           readonly>
                                                                </h5>
                                                                <button type="button" class="btn-close"
                                                                        data-bs-dismiss="modal"
                                                                        aria-label="Close"></button>
                                                            </div>

                                                            <div class="modal-body p-0">
                                                                <!-- Listing Progress Bar -->
                                                                <div class="d-flex gap-2 align-items-center border-bottom p-3">
                                                                    <strong>Progress:</strong>
                                                                    <div class="progress w-100">
                                                                        {% if listing.active %}
                                                                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                                                                 role="progressbar"
                                                                                 style="width: 100%;"
                                                                                 aria-valuenow="100"
                                                                                 aria-valuemin="0"
                                                                                 aria-valuemax="100">
                                                                                Active
                                                                            </div>
                                                                        {% elif listing.hold_for_import %}
                                                                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-warning"
                                                                                 role="progressbar"
                                                                                 style="width: 100%;"
                                                                                 aria-valuenow="100"
                                                                                 aria-valuemin="0"
                                                                                 aria-valuemax="100">
                                                                                On Hold
                                                                            </div>
                                                                        {% else %}
                                                                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-secondary"
                                                                                 role="progressbar"
                                                                                 style="width: 100%;"
                                                                                 aria-valuenow="100"
                                                                                 aria-valuemin="0"
                                                                                 aria-valuemax="100">
                                                                                Inactive
                                                                            </div>
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                                <div class="card-body">
                                                                    <!-- Full auction details go here -->
                                                                    <div class="row">
                                                                        <div class="col">
                                                                            <h3 class="border-bottom pb-2 mb-2">
                                                                                {% if listing.auction_type == 'Auction' %}
                                                                                    Auction{% else %}Sale{% endif %}
                                                                                Details</h3>
                                                                            {% if listing.auction_type == 'Auction' %}
                                                                                <div class="d-flex align-items-center gap-2 mt-2">
                                                                                    <strong>Auction Duration:</strong>
                                                                                    <select class="form-control readonly-input"
                                                                                            name="{{ listing.edit_form.auction_duration.html_name }}"
                                                                                            id="{{ listing.edit_form.auction_duration.id_for_label }}"
                                                                                            readonly>
                                                                                        {% for day in auction_durations %}
                                                                                            <option value="{{ day }}"
                                                                                                    {% if listing.edit_form.auction_duration.value == day|stringformat:"d" %}selected{% endif %}>
                                                                                                {{ day }} Days
                                                                                            </option>
                                                                                        {% endfor %}
                                                                                    </select>
                                                                                    <div class="text-muted">{{ listing.formatted_time_remaining }}
                                                                                        Remaining
                                                                                    </div>
                                                                                </div>
                                                                            {% else %}
                                                                                <!-- Hidden Inputs -->
                                                                                <input class="form-control readonly-input"
                                                                                       type="text"
                                                                                       name="{{ listing.edit_form.auction_duration.html_name }}"
                                                                                       id="{{ listing.edit_form.auction_duration.id_for_label }}"
                                                                                       value="{{ listing.edit_form.auction_duration.value }}"
                                                                                       readonly hidden>

                                                                            {% endif %}
                                                                        </div>
                                                                    </div>

                                                                    <div class="row">

                                                                        <div class="col">


                                                                            <!-- Description -->
                                                                            <div class="d-flex flex-column align-items-start gap-2 mt-2">
                                                                                <strong>Description:</strong>
                                                                                <textarea
                                                                                        class="form-control readonly-input"
                                                                                        type="text"
                                                                                        name="{{ listing.edit_form.description.html_name }}"
                                                                                        id="{{ listing.edit_form.description.id_for_label }}"

                                                                                        readonly>{{ listing.edit_form.description.value }}</textarea>
                                                                            </div>
                                                                            <div class="row">
                                                                                <div class="col">
                                                                                    <div class="listing-grid">
                                                                                        <strong>Manufacturer:</strong>
                                                                                        <input class="form-control readonly-input"
                                                                                               type="text"
                                                                                               name="{{ listing.edit_form.manufacturer.html_name }}"
                                                                                               id="{{ listing.edit_form.manufacturer.id_for_label }}"
                                                                                               value="{{ listing.edit_form.manufacturer.value }}"
                                                                                               readonly>
                                                                                    </div>
                                                                                    <div class="listing-grid">
                                                                                        <strong>Category:</strong>
                                                                                        <select class="form-control w-100 readonly-input"
                                                                                                name="{{ listing.edit_form.category.name }}"
                                                                                                id="{{ listing.edit_form.category.id_for_label }}">
                                                                                            {% for category in listing.edit_form.category.field.queryset %}
                                                                                                <option value="{{ category.id }}"
                                                                                                        {% if listing.edit_form.category.value == category.id %}selected{% endif %}>
                                                                                                    {{ category.category_name }}
                                                                                                </option>
                                                                                            {% endfor %}
                                                                                        </select>
                                                                                    </div>
                                                                                    <div class="listing-grid">
                                                                                        <strong>Quantity:</strong>
                                                                                        <input class="form-control readonly-input"
                                                                                               type="number"
                                                                                               name="{{ listing.edit_form.quantity_available.html_name }}"
                                                                                               id="{{ listing.edit_form.quantity_available.id_for_label }}"
                                                                                               value="{{ listing.edit_form.quantity_available.value }}"
                                                                                               readonly>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col">
                                                                                    {% if listing.auction_type == 'Auction' %}
                                                                                        <div class="listing-grid text-nowrap">
                                                                                            {% if listing.current_bid %}
                                                                                                <strong>Current
                                                                                                    Bid:</strong>
                                                                                                $
                                                                                                <input class="form-control readonly-input"
                                                                                                       type="text"
                                                                                                       name="{{ listing.edit_form.current_bid.html_name }}"
                                                                                                       id="{{ listing.edit_form.current_bid.id_for_label }}"
                                                                                                       value="{{ listing.edit_form.current_bid.value }}"
                                                                                                       readonly>
                                                                                            {% else %}
                                                                                                <strong>Starting
                                                                                                    Bid:</strong>
                                                                                                $
                                                                                                <input class="form-control readonly-input"
                                                                                                       type="text"
                                                                                                       name="{{ listing.edit_form.starting_bid.html_name }}"
                                                                                                       id="{{ listing.edit_form.starting_bid.id_for_label }}"
                                                                                                       value="{{ listing.edit_form.starting_bid.value }}"
                                                                                                       readonly>
                                                                                            {% endif %}
                                                                                        </div>
                                                                                        <div class="listing-grid text-nowrap">
                                                                                            <strong>Reserve
                                                                                                Bid:</strong>
                                                                                            $
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="text"
                                                                                                   name="{{ listing.edit_form.reserve_bid.html_name }}"
                                                                                                   id="{{ listing.edit_form.reserve_bid.id_for_label }}"
                                                                                                   value="{{ listing.edit_form.reserve_bid.value }}"
                                                                                                   aria-label=""
                                                                                                   readonly>

                                                                                            {% if listing.current_bid >= listing.reserve_bid %}
                                                                                                <div>Met</div>
                                                                                            {% else %}
                                                                                                <div>Not Met</div>
                                                                                            {% endif %}

                                                                                        </div>

                                                                                    {% else %}
                                                                                        <div class="listing-grid text-nowrap">
                                                                                            <strong>Get it
                                                                                                Now:</strong>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="text"
                                                                                                   name="{{ listing.edit_form.buyItNowPrice.html_name }}"
                                                                                                   id="{{ listing.edit_form.buyItNowPrice.id_for_label }}"
                                                                                                   value="{{ listing.edit_form.buyItNowPrice.value }}"
                                                                                                   readonly>
                                                                                        </div>
                                                                                    {% endif %}
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!-- Additional details fields can be added here if needed -->
                                                                    <div class="row">
                                                                        <h3 class="mt-3">Additional Details</h3>
                                                                        <div class="additional-details"
                                                                             id="details-{{ listing.id }}">

                                                                            <table class="table table-striped table-bordered">
                                                                                <thead>
                                                                                <tr>
                                                                                    <th scope="col">SKU</th>
                                                                                    <th scope="col">Reference Number
                                                                                    </th>
                                                                                    <th scope="col">Lot Number</th>
                                                                                    <th scope="col">Expiration Date</th>
                                                                                    <th scope="col">Production Date</th>
                                                                                </tr>
                                                                                </thead>
                                                                                <tbody>
                                                                                {{ listing.edit_form.management_form }}
                                                                                {{ listing.edit_form.product_detail.management_form }}
                                                                                {% for detail in listing.edit_form.product_detail %}
                                                                                    {{ detail.id }}
                                                                                    <tr>
                                                                                        <td>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="text"
                                                                                                   name="{{ detail.sku.html_name }}"
                                                                                                   id="{{ detail.sku.id_for_label }}"
                                                                                                   value="{{ detail.sku.value }}"
                                                                                                   readonly>
                                                                                        </td>
                                                                                        <td>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="text"
                                                                                                   name="{{ detail.reference_number.html_name }}"
                                                                                                   id="{{ detail.reference_number.id_for_label }}"
                                                                                                   value="{{ detail.reference_number.value }}"
                                                                                                   readonly>
                                                                                        </td>
                                                                                        <td>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="text"
                                                                                                   name="{{ detail.lot_number.html_name }}"
                                                                                                   id="{{ detail.lot_number.id_for_label }}"
                                                                                                   value="{{ detail.lot_number.value }}"
                                                                                                   readonly>
                                                                                        </td>
                                                                                        <td>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="date"
                                                                                                   name="{{ detail.production_date.html_name }}"
                                                                                                   id="{{ detail.production_date.id_for_label }}"
                                                                                                   value="{{ detail.production_date.value|date:'Y-m-d' }}"
                                                                                                   readonly>
                                                                                        </td>
                                                                                        <td>
                                                                                            <input class="form-control readonly-input"
                                                                                                   type="date"
                                                                                                   name="{{ detail.expiration_date.html_name }}"
                                                                                                   id="{{ detail.expiration_date.id_for_label }}"
                                                                                                   value="{{ detail.expiration_date.value|date:'Y-m-d' }}"
                                                                                                   readonly>
                                                                                        </td>
                                                                                    </tr>

                                                                                {% endfor %}
                                                                                </tbody>
                                                                            </table>
                                                                        </div>
                                                                    </div>


                                                                    <!-- Additional Details added by FDA -->
                                                                    <div class="row additional-listing-meta"
                                                                         id="additional-listing-meta-{{ listing.id }}">
                                                                        <div class="col-md-4 mb-3">
                                                                            <label for="{{ listing.edit_form.package_type.id_for_label }}"
                                                                                   class="form-label"><strong>Package
                                                                                Type:</strong></label>
                                                                            <select class="form-control w-100"
                                                                                    name="{{ listing.edit_form.package_type.html_name }}"
                                                                                    id="{{ listing.edit_form.package_type.id_for_label }}"
                                                                                    {% if listing.edit_form.package_type.attrs.readonly %}disabled{% endif %}>
                                                                                {% for choice_value, choice_label in listing.edit_form.package_type.field.choices %}
                                                                                    <option value="{{ choice_value }}"
                                                                                            {% if listing.edit_form.package_type.value == choice_value %}selected{% endif %}>
                                                                                        {{ choice_label }}
                                                                                    </option>
                                                                                {% endfor %}
                                                                            </select>
                                                                        </div>
                                                                        <div class="col-md-4 mb-3">
                                                                            <label for="{{ listing.edit_form.implantable.id_for_label }}"
                                                                                   class="form-label">
                                                                                <strong>Implantable:</strong>
                                                                            </label>
                                                                            <div class="form-check d-flex align-items-center gap-2">
                                                                                <input class="form-check-input readonly-input"
                                                                                       type="checkbox"
                                                                                       name="{{ listing.edit_form.implantable.html_name }}"
                                                                                       id="{{ listing.edit_form.implantable.id_for_label }}"
                                                                                       {% if listing.edit_form.implantable.value %}checked{% endif %}
                                                                                       disabled>
                                                                                <label class=""
                                                                                       for="{{ listing.edit_form.implantable.id_for_label }}">
                                                                                    Implantable
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-md-4 mb-3">
                                                                            <label for="{{ listing.edit_form.deviceSterile.id_for_label }}"
                                                                                   class="form-label">
                                                                                <strong>Sterile:</strong>
                                                                            </label>
                                                                            <div class="form-check d-flex align-items-center gap-2">
                                                                                <input class="form-check-input readonly-input"
                                                                                       type="checkbox"
                                                                                       name="{{ listing.edit_form.deviceSterile.html_name }}"
                                                                                       id="{{ listing.edit_form.deviceSterile.id_for_label }}"
                                                                                       {% if listing.edit_form.deviceSterile.value %}checked{% endif %}
                                                                                       disabled>
                                                                                <label class=""
                                                                                       for="{{ listing.edit_form.deviceSterile.id_for_label }}">
                                                                                    Sterile
                                                                                </label>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <h3 class="mt-3">Images</h3>
                                                                    <div class="additional-images"
                                                                         id="additional-images-{{ listing.id }}">
                                                                        <!-- Images will be loaded here via AJAX -->
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="modal-footer bg-light">
                                                                <button type="button" class="btn btn-secondary"
                                                                        data-bs-dismiss="modal"
                                                                        onclick="disableEditing({{ listing.id }})">
                                                                    Close
                                                                </button>
                                                                {% if listing.hold_for_import %}
                                                                    <button type="button" class="btn btn-primary"
                                                                            id="editButton{{ listing.id }}"
                                                                            onclick="enableEditing({{ listing.id }})">
                                                                        Edit
                                                                    </button>
                                                                {% endif %}
                                                                <button type="submit"
                                                                        form="editAuctionForm{{ listing.id }}"
                                                                        class="btn btn-success"
                                                                        id="saveButton{{ listing.id }}"
                                                                        style="display: none;"
                                                                        onclick="submitForm(event, {{ listing.id }})">
                                                                    Save
                                                                </button>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </form>
                                            </div>



                                        {% empty %}
                                            <tr>
                                                <td colspan="3">No listings found.</td>
                                            </tr>
                                        {% endfor %}
                                    </div>


                                    {% if listings.has_other_pages %}
                                        <div class='d-flex justify-content-center'>
                                            <ul class='pagination flex-wrap justify-content-center'>

                                                <!-- Previous Page Link -->
                                                {% if listings.has_previous %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?listings_page={{ listings.previous_page_number }}&active_tab=listings&listing_status={{ listing_status }}&listing_type={{ listing_type }}&listing_date={{ listing_date }}&hold_for_import={{ hold_for_import }}'>
                                                            &laquo;
                                                        </a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&laquo;</a>
                                                    </li>
                                                {% endif %}

                                                <!-- First Page Link and Ellipsis -->
                                                {% if listings.number > 3 %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?listings_page=1&active_tab=listings&listing_status={{ listing_status }}&listing_type={{ listing_type }}&listing_date={{ listing_date }}&hold_for_import={{ hold_for_import }}'>1</a>
                                                    </li>
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Page Range Around Current Page -->
                                                {% for i in listings.paginator.page_range %}
                                                    {% if i >= listings.number|add:'-2' and i <= listings.number|add:'2' %}
                                                        {% if listings.number == i %}
                                                            <li class='page-item active'>
                                                                <a class='page-link' href='#'>{{ i }}</a>
                                                            </li>
                                                        {% else %}
                                                            <li class='page-item'>
                                                                <a class='page-link'
                                                                   href='?listings_page={{ i }}&active_tab=listings&listing_status={{ listing_status }}&listing_type={{ listing_type }}&listing_date={{ listing_date }}&hold_for_import={{ hold_for_import }}'>{{ i }}</a>
                                                            </li>
                                                        {% endif %}
                                                    {% endif %}
                                                {% endfor %}

                                                <!-- Last Page Link and Ellipsis -->
                                                {% if listings.number < listings.paginator.num_pages|add:'-2' %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>...</a>
                                                    </li>
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?listings_page={{ listings.paginator.num_pages }}&active_tab=listings&listing_status={{ listing_status }}&listing_type={{ listing_type }}&listing_date={{ listing_date }}&hold_for_import={{ hold_for_import }}'>{{ listings.paginator.num_pages }}</a>
                                                    </li>
                                                {% endif %}

                                                <!-- Next Page Link -->
                                                {% if listings.has_next %}
                                                    <li class='page-item'>
                                                        <a class='page-link'
                                                           href='?listings_page={{ listings.next_page_number }}&active_tab=listings&listing_status={{ listing_status }}&listing_type={{ listing_type }}&listing_date={{ listing_date }}&hold_for_import={{ hold_for_import }}'>&raquo;</a>
                                                    </li>
                                                {% else %}
                                                    <li class='page-item disabled'>
                                                        <a class='page-link' href='#'>&raquo;</a>
                                                    </li>
                                                {% endif %}

                                            </ul>
                                        </div>
                                    {% endif %}


                                </div>
                            </div>
                        </div>

                        <!-- My Settings -->
                        <div class="tab-pane fade {% if active_tab == 'settings' %}show active{% endif %}" id="settings"
                             role="tabpanel" aria-labelledby="settings-tab">
                            <div class='my-2 border-top'>
                                <div class='card-header d-flex justify-content-between align-items-center'>
                                    <div class="py-2">
                                        <i class="fa-solid fa-gears me-1"></i>
                                        Settings
                                    </div>
                                </div>
                            </div>
                            <div class="card-body">
                                <!-- Tab Navigation for Desktop -->
                                <ul class="nav nav-tabs mb-3 d-none d-md-flex" id="settingsTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link sub-nav {% if sub_nav == 'user_details' or sub_nav == '' %}active{% endif %}"
                                                id="user-details-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#user-details"
                                                type="button" role="tab" aria-controls="user-details"
                                                aria-selected="{% if sub_nav == 'user_details' or sub_nav == '' %}true{% else %}false{% endif %}">
                                            User Details
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link sub-nav {% if sub_nav == 'billing_address' %}active{% endif %}"
                                                id="billing-address-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#billing-address"
                                                type="button" role="tab" aria-controls="billing-address"
                                                aria-selected="{% if sub_nav == 'billing_address' %}true{% else %}false{% endif %}">
                                            Billing Address
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link sub-nav {% if sub_nav == 'shipping_address' %}active{% endif %}"
                                                id="shipping-address-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#shipping-address"
                                                type="button" role="tab" aria-controls="shipping-address"
                                                aria-selected="{% if sub_nav == 'shipping_address' %}true{% else %}false{% endif %}">
                                            Shipping Address
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link sub-nav {% if sub_nav == 'shipping_account' %}active{% endif %}"
                                                id="shipping-account-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#shipping-account"
                                                type="button" role="tab" aria-controls="shipping-account"
                                                aria-selected="{% if sub_nav == 'shipping_account' %}true{% else %}false{% endif %}">
                                            Shipping Account
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link sub-nav {% if sub_nav == 'password' %}active{% endif %}"
                                                id="password-tab"
                                                data-bs-toggle="tab"
                                                data-bs-target="#password"
                                                type="button" role="tab" aria-controls="password"
                                                aria-selected="{% if sub_nav == 'password' %}true{% else %}false{% endif %}">
                                            Change Password
                                        </button>
                                    </li>
                                </ul>

                                <!-- Dropdown Menu for Mobile -->
                                <div class="dropdown d-md-none mb-3">
                                    <button class="btn btn-primary dropdown-toggle w-100" type="button"
                                            id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="fas fa-bars me-2"></i> Menu
                                    </button>
                                    <ul class="dropdown-menu w-100" aria-labelledby="dropdownMenuButton">
                                        <li>
                                            <a class="dropdown-item {% if sub_nav == 'user_details' or sub_nav == '' %}active{% endif %}"
                                               href="#user-details" data-bs-toggle="tab" role="tab">User Details</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item {% if sub_nav == 'billing_address' %}active{% endif %}"
                                               href="#billing-address" data-bs-toggle="tab" role="tab">Billing
                                                Address</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item {% if sub_nav == 'shipping_address' %}active{% endif %}"
                                               href="#shipping-address" data-bs-toggle="tab" role="tab">Shipping
                                                Address</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item {% if sub_nav == 'shipping_account' %}active{% endif %}"
                                               href="#shipping-account" data-bs-toggle="tab" role="tab">Shipping
                                                Account</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item {% if sub_nav == 'password' %}active{% endif %}"
                                               href="#password" data-bs-toggle="tab" role="tab">Change Password</a>
                                        </li>
                                    </ul>
                                </div>

                                <!-- Tab Content -->
                                <div class="tab-content" id="settingsTabContent">
                                    <!-- User Details Tab -->
                                    <div class="tab-pane fade show active" id="user-details" role="tabpanel"
                                         aria-labelledby="user-details-tab">
                                        <form id="settings-form" method="post" enctype="multipart/form-data">
                                            {% csrf_token %}
                                            <!-- User Info -->
                                            <h5>User Information</h5>
                                            <div class="card-body row">
                                                <div class="col-md-6">
                                                    <!-- Username -->
                                                    <div class="mb-3">
                                                        <label for="{{ settings_form.username.id_for_label }}"
                                                               class="form-label">Username</label>
                                                        <input type="text" name="{{ settings_form.username.name }}"
                                                               id="{{ settings_form.username.id_for_label }}"
                                                               value="{{ settings_form.username.value }}"
                                                               class="form-control">
                                                        {% if settings_form.username.errors %}
                                                            <div class="text-danger">
                                                                {{ settings_form.username.errors }}
                                                            </div>
                                                        {% endif %}
                                                    </div>

                                                    <!-- Email -->
                                                    <div class="mb-3">
                                                        <label for="{{ settings_form.email.id_for_label }}"
                                                               class="form-label">Email</label>
                                                        <input type="email" name="{{ settings_form.email.name }}"
                                                               id="{{ settings_form.email.id_for_label }}"
                                                               value="{{ settings_form.email.value }}"
                                                               class="form-control">
                                                        {% if settings_form.email.errors %}
                                                            <div class="text-danger">
                                                                {{ settings_form.email.errors }}
                                                            </div>
                                                        {% endif %}
                                                    </div>

                                                    <!-- Company Name -->
                                                    <div class="mb-3">
                                                        <label for="{{ settings_form.company_name.id_for_label }}"
                                                               class="form-label">Company
                                                            Name</label>
                                                        <input type="text"
                                                               name="{{ settings_form.company_name.name }}"
                                                               id="{{ settings_form.company_name.id_for_label }}"
                                                               value="{{ settings_form.company_name.value }}"
                                                               class="form-control">
                                                        {% if settings_form.company_name.errors %}
                                                            <div class="text-danger">
                                                                {{ settings_form.company_name.errors }}
                                                            </div>
                                                        {% endif %}
                                                    </div>

                                                    <!-- Phone Number -->
                                                    <div class="mb-3">
                                                        <label for="{{ settings_form.phone_number.id_for_label }}"
                                                               class="form-label">Phone
                                                            Number</label>
                                                        <input type="text"
                                                               name="{{ settings_form.phone_number.name }}"
                                                               id="{{ settings_form.phone_number.id_for_label }}"
                                                               value="{{ settings_form.phone_number.value }}"
                                                               class="form-control">
                                                        {% if settings_form.phone_number.errors %}
                                                            <div class="text-danger">
                                                                {{ settings_form.phone_number.errors }}
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <div class="col-md-6">

                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <!-- Profile Image -->
                                                            <div class="mb-3">
                                                                <label for="{{ settings_form.profile_image.id_for_label }}"
                                                                       class="form-label">Profile Image</label>

                                                                {% if user.profile_image %}
                                                                    <div class="mb-2">
                                                                        <a href="{{ user.profile_image.url }}"
                                                                           target="_blank"><img
                                                                                src="{{ user.profile_image.url }}"
                                                                                alt="Profile Image"
                                                                                class="img-thumbnail"
                                                                                style="height: 100px;"></a>
                                                                    </div>
                                                                {% endif %}
                                                                <div>{% if user.profile_image %}Replace{% else %}
                                                                    Add{% endif %} Profile Image
                                                                </div>
                                                                <input type="file"
                                                                       name="{{ settings_form.profile_image.name }}"
                                                                       id="{{ settings_form.profile_image.id_for_label }}"
                                                                       class="form-control">
                                                                {% if settings_form.profile_image.errors %}
                                                                    <div class="text-danger">{{ settings_form.profile_image.errors }}</div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <!-- Company Logo -->
                                                            <div class="mb-3">
                                                                <label for="{{ settings_form.company_logo.id_for_label }}"
                                                                       class="form-label">Company Logo</label>

                                                                {% if user.company_logo %}
                                                                    <div class="mb-2">

                                                                        <a href="{{ user.company_logo.url }}"
                                                                           target="_blank"><img
                                                                                src="{{ user.company_logo.url }}"
                                                                                alt="Company Logo"
                                                                                class="img-thumbnail"
                                                                                style="height: 100px;"></a>
                                                                    </div>
                                                                {% endif %}
                                                                <div>{% if user.company_logo %}Replace{% else %}
                                                                    Add{% endif %} Company Logo
                                                                </div>
                                                                <input type="file"
                                                                       name="{{ settings_form.company_logo.name }}"
                                                                       id="{{ settings_form.company_logo.id_for_label }}"
                                                                       class="form-control">
                                                                {% if settings_form.company_logo.errors %}
                                                                    <div class="text-danger">{{ settings_form.company_logo.errors }}</div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <!-- Company W9 -->
                                                            <div class="mb-3">
                                                                <label for="{{ settings_form.company_w9.id_for_label }}"
                                                                       class="form-label">
                                                                    <div>
                                                                        {% if settings_form.company_w9 %}
                                                                            Replace{% else %}
                                                                            Add{% endif %} Company W9
                                                                    </div>
                                                                </label>
                                                                <input type="file"
                                                                       name="{{ settings_form.company_w9.name }}"
                                                                       id="{{ settings_form.company_w9.id_for_label }}"
                                                                       class="form-control">
                                                                {% if settings_form.company_w9.errors %}
                                                                    <div class="text-danger">{{ settings_form.company_w9.errors }}</div>
                                                                {% endif %}
                                                                {% if user.company_w9 %}
                                                                    <div class="my-2">
                                                                        <p><a href="{{ user.company_w9.url }}"
                                                                              target="_blank">Download W9</a></p>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <!-- Reseller Certificate -->
                                                            <div class="mb-3">
                                                                <label for="{{ settings_form.reseller_cert.id_for_label }}"
                                                                       class="form-label">
                                                                    <div>
                                                                        {% if settings_form.reseller_cert %}
                                                                            Replace{% else %}
                                                                            Add{% endif %} Reseller Certificate
                                                                    </div>

                                                                </label>


                                                                <input type="file"
                                                                       name="{{ settings_form.reseller_cert.name }}"
                                                                       id="{{ settings_form.reseller_cert.id_for_label }}"
                                                                       class="form-control">
                                                                {% if settings_form.reseller_cert.errors %}
                                                                    <div class="text-danger">{{ settings_form.reseller_cert.errors }}</div>
                                                                {% endif %}
                                                                {% if user.reseller_cert %}
                                                                    <div class="my-2">
                                                                        <a href="{{ user.reseller_cert.url }}"
                                                                           target="_blank">Download
                                                                            Reseller Certificate</a>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                            <!-- Submit Button -->
                                            <button class="save-all-forms-btn btn btn-primary" type="button">Save
                                                Settings
                                            </button>
                                        </form>
                                    </div>
                                    <!-- Billing Address Tab -->
                                    <div class="tab-pane fade" id="billing-address" role="tabpanel"
                                         aria-labelledby="billing-address-tab">
                                        <form id="billing-form" method="post">
                                            <!-- Billing and Shipping Addresses -->
                                            <h5>Billing Address</h5>
                                            <div class="card-body row">
                                                <!-- Billing Address -->
                                                <div class="col-md-6">
                                                    <input type="hidden" name="{{ billing_form.address_type.name }}"
                                                           value="billing">
                                                    <!-- Street Address -->
                                                    <div class="mb-3">
                                                        <label for="{{ billing_form.street.id_for_label }}"
                                                               class="form-label">Street
                                                            Address</label>
                                                        <input type="text" name="{{ billing_form.street.name }}"
                                                               id="{{ billing_form.street.id_for_label }}"
                                                               value="{{ billing_form.street.value }}"
                                                               class="form-control">
                                                        {% if billing_form.street.errors %}
                                                            <div class="text-danger">{{ billing_form.street.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                    <!-- Street Address 2 -->
                                                    <div class="mb-3">
                                                        <label for="{{ billing_form.suite.id_for_label }}"
                                                               class="form-label">Street
                                                            Address 2</label>
                                                        <input type="text" name="{{ billing_form.suite.name }}"
                                                               id="{{ billing_form.suite.id_for_label }}"
                                                               value="{{ billing_form.suite.value }}"
                                                               class="form-control">
                                                        {% if billing_form.suite.errors %}
                                                            <div class="text-danger">{{ billing_form.suite.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                    <!-- City, State Zip -->
                                                    <div class="row">
                                                        <!-- City -->
                                                        <div class="col-md-6 mb-3">
                                                            <label for="{{ billing_form.city.id_for_label }}"
                                                                   class="form-label">City</label>
                                                            <input type="text" name="{{ billing_form.city.name }}"
                                                                   id="{{ billing_form.city.id_for_label }}"
                                                                   value="{{ billing_form.city.value }}"
                                                                   class="form-control">
                                                            {% if billing_form.city.errors %}
                                                                <div class="text-danger">{{ billing_form.city.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                        <!-- State -->
                                                        <div class="col-md-3 mb-3">
                                                            <label for="{{ billing_form.state.id_for_label }}"
                                                                   class="form-label">State</label>
                                                            <select name="{{ billing_form.state.name }}"
                                                                    id="{{ billing_form.state.id_for_label }}"
                                                                    class="form-control w-100">

                                                                {% for state in billing_form.state.field.choices %}
                                                                    <option value="{{ state.0 }}"
                                                                            {% if state.0 == billing_form.state.value %}selected{% endif %}>
                                                                        {{ state.1 }}
                                                                    </option>
                                                                {% endfor %}
                                                            </select>
                                                            {% if billing_form.state.errors %}
                                                                <div class="text-danger">{{ billing_form.state.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                        <!-- Zip Code -->
                                                        <div class="col-md-3 mb-3">
                                                            <label for="{{ billing_form.zip_code.id_for_label }}"
                                                                   class="form-label">Zip Code</label>
                                                            <input type="text" name="{{ billing_form.zip_code.name }}"
                                                                   id="{{ billing_form.zip_code.id_for_label }}"
                                                                   value="{{ billing_form.zip_code.value }}"
                                                                   class="form-control">
                                                            {% if billing_form.zip_code.errors %}
                                                                <div class="text-danger">{{ billing_form.zip_code.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <!-- Country -->
                                                    <div class="mb-3">
                                                        <label for="{{ billing_form.country.id_for_label }}"
                                                               class="form-label">Country</label>
                                                        <input type="text" name="{{ billing_form.country.name }}"
                                                               id="{{ billing_form.country.id_for_label }}"
                                                               value="{{ billing_form.country.value }}"
                                                               class="form-control">
                                                        {% if billing_form.country.errors %}
                                                            <div class="text-danger">{{ billing_form.country.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Submit Button -->
                                            <button class="save-all-forms-btn btn btn-primary" type="button"
                                                    class="btn btn-primary">Save
                                                Settings
                                            </button>
                                        </form>
                                    </div>
                                    <!-- Shipping Address Tab -->
                                    <div class="tab-pane fade" id="shipping-address" role="tabpanel"
                                         aria-labelledby="shipping-address-tab">
                                        <form id="shipping-form" method="post">
                                            <h5>Shipping Address</h5>
                                            <div class="card-body row">
                                                <!-- Shipping Address -->
                                                <div class="col-md-6">
                                                    <input type="hidden" name="{{ shipping_form.address_type.name }}"
                                                           value="shipping">
                                                    <!-- Street Address -->
                                                    <div class="mb-3">
                                                        <label for="{{ shipping_form.street.id_for_label }}"
                                                               class="form-label">Street
                                                            Address</label>
                                                        <input type="text" name="{{ shipping_form.street.name }}"
                                                               id="{{ shipping_form.street.id_for_label }}"
                                                               value="{{ shipping_form.street.value }}"
                                                               class="form-control">
                                                        {% if shipping_form.street.errors %}
                                                            <div class="text-danger">{{ shipping_form.street.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                    <!-- Suite -->
                                                    <div class="mb-3">
                                                        <label for="{{ shipping_form.suite.id_for_label }}"
                                                               class="form-label">Street Address 2</label>
                                                        <input type="text" name="{{ shipping_form.suite.name }}"
                                                               id="{{ shipping_form.suite.id_for_label }}"
                                                               value="{{ shipping_form.suite.value }}"
                                                               class="form-control">
                                                        {% if shipping_form.suite.errors %}
                                                            <div class="text-danger">{{ shipping_form.suite.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                    <!-- City, State Zip -->
                                                    <div class="row">

                                                        <!-- City -->
                                                        <div class="col-md-6 mb-3">
                                                            <label for="{{ shipping_form.city.id_for_label }}"
                                                                   class="form-label">City</label>
                                                            <input type="text" name="{{ shipping_form.city.name }}"
                                                                   id="{{ shipping_form.city.id_for_label }}"
                                                                   value="{{ shipping_form.city.value }}"
                                                                   class="form-control">
                                                            {% if shipping_form.city.errors %}
                                                                <div class="text-danger">{{ shipping_form.city.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                        <!-- State -->
                                                        <div class="col-md-3 mb-3">
                                                            <label for="{{ shipping_form.state.id_for_label }}"
                                                                   class="form-label">State</label>
                                                            <select name="{{ shipping_form.state.name }}"
                                                                    id="{{ shipping_form.state.id_for_label }}"
                                                                    class="form-control w-100">

                                                                {% for state in shipping_form.state.field.choices %}
                                                                    <option value="{{ state.0 }}"
                                                                            {% if state.0 == shipping_form.state.value %}selected{% endif %}>
                                                                        {{ state.1 }}
                                                                    </option>
                                                                {% endfor %}
                                                            </select>
                                                            {% if shipping_form.state.errors %}
                                                                <div class="text-danger">{{ shipping_form.state.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                        <!-- Zip Code -->
                                                        <div class="col-md-3 mb-3">
                                                            <label for="{{ shipping_form.zip_code.id_for_label }}"
                                                                   class="form-label">Zip Code</label>
                                                            <input type="text" name="{{ shipping_form.zip_code.name }}"
                                                                   id="{{ shipping_form.zip_code.id_for_label }}"
                                                                   value="{{ shipping_form.zip_code.value }}"
                                                                   class="form-control">
                                                            {% if shipping_form.zip_code.errors %}
                                                                <div class="text-danger">{{ shipping_form.zip_code.errors }}</div>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <!-- Country -->
                                                    <div class="mb-3">
                                                        <label for="{{ shipping_form.country.id_for_label }}"
                                                               class="form-label">Country</label>
                                                        <input type="text" name="{{ shipping_form.country.name }}"
                                                               id="{{ shipping_form.country.id_for_label }}"
                                                               value="{{ shipping_form.country.value }}"
                                                               class="form-control">
                                                        {% if shipping_form.country.errors %}
                                                            <div class="text-danger">{{ shipping_form.country.errors }}</div>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Submit Button -->
                                            <button class="save-all-forms-btn btn btn-primary" type="button"
                                                    class="btn btn-primary">Save
                                                Settings
                                            </button>
                                        </form>
                                    </div>
                                    <!-- Shipping Accounts Tab -->
                                    <div class="tab-pane fade" id="shipping-account" role="tabpanel"
                                         aria-labelledby="shipping-account-tab">
                                        <form id="shipping-account-form" method="post">
                                            <!-- Account Number -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ shipping_account_form.carrier_account_number.id_for_label }}"
                                                       class="form-label">Carrier Account Number</label>
                                                <input type="text"
                                                       name="{{ shipping_account_form.carrier_account_number.name }}"
                                                       id="{{ shipping_account_form.carrier_account_number.id_for_label }}"
                                                       value="{{ shipping_account_form.carrier_account_number.value|default_if_none:'' }}"
                                                       class="form-control text-uppercase">
                                                {% if shipping_account_form.carrier_account_number.errors %}
                                                    <div class="text-danger">{{ shipping_account_form.carrier_account_number.errors }}</div>
                                                {% endif %}
                                            </div>
                                            <!-- Carrier Name -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ shipping_account_form.carrier_name.id_for_label }}"
                                                       class="form-label">Carrier Name</label>
                                                <select name="{{ shipping_account_form.carrier_name.name }}"
                                                        id="{{ shipping_account_form.carrier_name.id_for_label }}"
                                                        class="form-control w-100">
                                                    {% for choice in shipping_account_form.carrier_name.field.choices %}
                                                        <option value="{{ choice.0 }}"
                                                                {% if choice.0 == shipping_account_form.carrier_name.value %}selected{% endif %}>
                                                            {{ choice.1 }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                                {% if shipping_account_form.carrier_name.errors %}
                                                    <div class="text-danger">{{ shipping_account_form.carrier_name.errors }}</div>
                                                {% endif %}
                                            </div>
                                            <!-- Shipping Account -->
                                            <div class="col-md-6 mb-3 d-flex gap-2 align-items-center">
                                                <input class="form-check-input m-0" type="checkbox"
                                                       id="{{ shipping_account_form.use_as_default_shipping_method.id_for_label }}"
                                                        {% if shipping_account_form.use_as_default_shipping_method.value %}
                                                       checked {% endif %}>

                                                <label for="{{ shipping_account_form.use_as_default_shipping_method.id_for_label }}"
                                                       class="form-label m-0">Default for all orders</label>
                                            </div>

                                            <!-- Submit Button -->
                                            <button class="save-all-forms-btn btn btn-primary" type="button"
                                                    class="btn btn-primary">Save
                                                Settings
                                            </button>
                                        </form>
                                    </div>
                                    <!-- Password Reset -->
                                    <div class="tab-pane fade {% if active_tab == 'password' %}show active{% endif %}"
                                         id="password" role="tabpanel"
                                         aria-labelledby="password-tab">

                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <form method="post" action="{% url 'password_change' %}">
                                                        {% csrf_token %}
                                                        {{ password_form.as_p }}
                                                        <button type="submit" class="btn btn-primary">Change Password
                                                        </button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>


                                    </div>


                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <link href='{% static "css/dashboard.css" %}' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="{% static 'js/dashboard.js' %}"></script>
    <script>
        $(document).ready(function () {
            $('.save-all-forms-btn').on('click', function () {
                submitAllForms('{% url "save_all_forms" %}');
            });
        })
    </script>


{% endblock %}