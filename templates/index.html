{% extends 'new_base.html' %}
{% load static %}
{% block title %}Auctions | {{ title }} {% endblock %}

{% block links %}
    <script id="cookieyes" type="text/javascript"
            src="https://cdn-cookieyes.com/client_data/df1073b472fdc497671c74e5/script.js"></script>
    <link href='{% static "css/index.css" %}' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
{% endblock %}


{% block body %}
    <div class=container style="padding: 0;">
        
        <section class="hero">
            {% include 'hero.html' %}
        </section>


        <section class="featured-auctions container">
            {% if user.is_authenticated %}
                {% if recent_views %}
                    <div class="auctions-category mb-5">
                        <h2>
                            <a href="{% url 'active_auctions_view' %}?recent_views=1">Recently Viewed</a>
                        </h2>
                        <div class="auction-items grid">
                            {% for view in recent_views %}
                                <div class="auction-item-container">
                                    <a class="auction-item" href="{% url 'active_auctions_with_id' view.auction.id %}">
                                        {% if view.auction.get_images.first %}
                                            <img src="{{ view.auction.get_images.first.image.url }}"
                                                 alt="{{ view.auction.title }}">
                                        {% else %}
                                            <img src="{% static 'images/no_image.png' %}" alt="Default Image">
                                        {% endif %}
                                        <h3>{{ view.auction.title|truncatechars:30 }}</h3>
                                        <p>{{ view.auction.category }}</p>
                                        {% if view.auction.auction_type == 'Auction' %}
                                            <h3>
                                                {% if view.auction.current_bid %}
                                                    ${{ view.auction.current_bid }}
                                                    <div class="fs-5 fw-light fst-italic">Current Bid</div>
                                                {% else %}
                                                    ${{ view.auction.starting_bid }}
                                                    <div class="fs-5 fw-light fst-italic">Starting Bid</div>
                                                {% endif %}
                                                <div class="lead time-remaining">{{ view.auction.formatted_time_remaining }}
                                                    Remaining
                                                </div>
                                            </h3>
                                        {% else %}
                                            <h3>
                                                ${{ view.auction.buyItNowPrice }}
                                                <div class="fs-5 fw-light fst-italic">Get it Now</div>
                                            </h3>
                                        {% endif %}
                                    </a>
                                    <a class='btn btn-secondary mt-auto rounded watch-button'
                                       href="{% url 'watchlist_edit' view.auction.id 'active_auctions_with_id' %}">
                                        {% if view.is_watched %}
                                            <i class="fa-solid fa-eye-slash"></i>
                                        {% else %}
                                            <i class="fa-regular fa-eye"></i>
                                        {% endif %}
                                    </a>

                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
                {% if watchlist %}
                    <div class="auctions-category mb-5">
                        <h2>Your Watchlist</h2>
                        <div class="auction-items grid">

                            {% for auction in watchlist %}
                                <div class="auction-item-container">
                                    <a class="auction-item" href="{% url 'active_auctions_with_id' auction.id %}">
                                        {% if auction.image %}
                                            <img src="{{ auction.image.image.url }}" alt="{{ auction.title }}">
                                        {% else %}
                                            <img src="{% static 'images/no_image.png' %}" alt="Default Image">
                                        {% endif %}
                                        <h3>{{ auction.title|truncatechars:30 }}</h3>
                                        <p>{{ auction.category }}</p>
                                        {% if auction.auction_type == 'Auction' %}
                                            <h3>
                                                {% if view.auction.current_bid %}
                                                    ${{ auction.current_bid }}
                                                    <div class="fs-5 fw-light fst-italic">Current Bid</div>
                                                {% else %}
                                                    ${{ auction.starting_bid }}
                                                    <div class="fs-5 fw-light fst-italic">Starting Bid</div>
                                                {% endif %}
                                                <div class="lead time-remaining">{{ auction.formatted_time_remaining }}
                                                    Remaining
                                                </div>
                                            </h3>
                                        {% else %}
                                            <h3>
                                                ${{ auction.buyItNowPrice }}
                                                <div class="fs-5 fw-light fst-italic">Get it Now</div>
                                            </h3>
                                        {% endif %}
                                    </a>
                                    <a class='btn btn-secondary mt-auto rounded watch-button'
                                       href="{% url 'watchlist_edit' auction.id 'index' %}">
                                        <i class="fa-solid fa-eye-slash"></i>
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endif %}

            <div class="auctions-category mb-5">
            <h2>{{ auctions_cat1_name }}</h2>
                <div class="auction-items grid">
                    {% for auction in auctions_cat1 %}
                        <div class="auction-item-container">
                            <a class="auction-item" href="{% url 'active_auctions_with_id' auction.id %}">
                                {% if auction.image %}
                                    <img src="{{ auction.image.image.url }}" alt="{{ auction.title }}">
                                {% else %}
                                    <img src="{% static 'images/no_image.png' %}" alt="Default Image">
                                {% endif %}
                                <h3>{{ auction.title|truncatechars:30 }}</h3>
                                <p>{{ auction.category }}</p>
                                {% if auction.auction_type == 'Auction' %}
                                    <h3>
                                        {% if view.auction.current_bid %}
                                            ${{ auction.current_bid }}
                                            <div class="fs-5 fw-light fst-italic">Current Bid</div>
                                        {% else %}
                                            ${{ auction.starting_bid }}
                                            <div class="fs-5 fw-light fst-italic">Starting Bid</div>
                                        {% endif %}
                                        <div class="lead time-remaining">{{ view.auction.formatted_time_remaining }}
                                            Remaining
                                        </div>
                                    </h3>
                                {% else %}
                                    <h3>
                                        ${{ auction.buyItNowPrice }}
                                        <div class="fs-5 fw-light fst-italic">Get it Now</div>

                                    </h3>
                                {% endif %}
                            </a>
                            <a class='btn btn-secondary mt-auto rounded watch-button'
                               href="{% url 'watchlist_edit' auction.id 'active_auctions_with_id' %}">
                                {% if auction.is_watched %}
                                    <i class="fa-solid fa-eye-slash"></i>
                                {% else %}
                                    <i class="fa-regular fa-eye"></i>
                                {% endif %}
                            </a>
                        </div>
                    {% endfor %}
                </div>
            </div>
            <div class="auctions-category mb-5">
                <h2>{{ auctions_cat2_name }}</h2>
                <div class="auction-items grid">
                    {% for auction in auctions_cat2 %}
                        <div class="auction-item-container">
                            <a class="auction-item" href="{% url 'active_auctions_with_id' auction.id %}">
                                {% if auction.image %}
                                    <img src="{{ auction.image.image.url }}" alt="{{ auction.title }}">
                                {% else %}
                                    <img src="{% static 'images/no_image.png' %}" alt="Default Image">
                                {% endif %}
                                <h3>{{ auction.title|truncatechars:30 }}</h3>
                                <p>{{ auction.category }}</p>
                                {% if auction.auction_type == 'Auction' %}
                                    <h3>
                                        {% if view.auction.current_bid %}
                                            ${{ auction.current_bid }}
                                            <div class="fs-5 fw-light fst-italic">Current Bid</div>

                                        {% else %}
                                            ${{ auction.starting_bid }}
                                            <div class="fs-5 fw-light fst-italic">Starting Bid</div>
                                        {% endif %}
                                        <div class="lead time-remaining">{{ view.auction.formatted_time_remaining }}
                                            Remaining
                                        </div>
                                    </h3>
                                {% else %}
                                    <h3>
                                        ${{ auction.buyItNowPrice }}
                                        <div class="fs-5 fw-light fst-italic">Get it Now</div>
                                    </h3>
                                {% endif %}
                            </a>
                            <a class='btn btn-secondary mt-auto rounded watch-button'
                               href="{% url 'watchlist_edit' auction.id 'active_auctions_with_id' %}">
                                {% if auction.is_watched %}
                                    <i class="fa-solid fa-eye-slash"></i>
                                {% else %}
                                    <i class="fa-regular fa-eye"></i>
                                {% endif %}
                            </a>
                        </div>


                    {% endfor %}
                </div>
            </div>

        </section>
        {#        <script>#}
        {#            document.addEventListener('DOMContentLoaded', function () {#}
        {#                const buttons = document.querySelectorAll('.watchlist-btn');#}
        {##}
        {#                buttons.forEach(function (button) {#}
        {#                    button.addEventListener('click', function (event) {#}
        {#                        event.stopPropagation(); // Prevent the click event from propagating to the parent <a> element#}
        {#                        const auctionId = button.getAttribute('data-auction-id');#}
        {#                        const url = `{% url 'watchlist_edit' 0 'active_auctions_with_id' %}`.replace('0', auctionId);#}
        {#                        window.location.href = url;#}
        {#                    });#}
        {#                });#}
        {#            });#}
        {#        </script>#}


        {#        <section class="testimonials">#}
        {#            <h2>What Our Clients Say</h2>#}
        {#            <div class="carousel">#}
        {#                <div class="testimonial">#}
        {#                    <p>"Great platform for finding the best healthcare equipment!"</p>#}
        {#                    <span>- Client Name</span>#}
        {#                </div>#}
        {#                <div class="testimonial">#}
        {#                    <p>"Easy to use and reliable service."</p>#}
        {#                    <span>- Client Name</span>#}
        {#                </div>#}
        {#                <div class="testimonial">#}
        {#                    <p>"Highly recommend Healthcare Auctions for their excellent support."</p>#}
        {#                    <span>- Client Name</span>#}
        {#                </div>#}
        {#            </div>#}
        {#        </section>#}

        <section class="call-to-action">
            <h2>Ready to Start Bidding?</h2>
            <p>Join us today and find the best deals on healthcare equipment.</p>
            <a href="{% url 'register' %}" class="button primary">Sign Up Now</a>
        </section>
    </div>
{% endblock %}



